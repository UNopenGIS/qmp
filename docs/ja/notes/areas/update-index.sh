#!/bin/zsh

# Areas index.md è‡ªå‹•æ›´æ–°ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
# Usage: ./update-index.sh

echo "ğŸ—ºï¸ Areas index.md è‡ªå‹•æ›´æ–°é–‹å§‹"
echo "================================\n"

# ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®è¨­å®š
AREAS_DIR="/Volumes/Migrate-2025-04/github/qmp/docs/ja/notes/areas"
cd "$AREAS_DIR" || exit 1

# å›½ãƒ»åœ°åŸŸæƒ…å ±ã‚’æŠ½å‡ºã™ã‚‹é–¢æ•°
extract_country_info() {
    local file="$1"
    local country_code="${file%.md}"
    
    # ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰åŸºæœ¬æƒ…å ±ã‚’æŠ½å‡º
    local country_name=$(grep -A1 "^# $country_code" "$file" 2>/dev/null | tail -1 | sed 's/.*ã«ãŠã‘ã‚‹OpenStreetMap.*//' | sed 's/^## Notes$//')
    local daily_members=$(grep "1æ—¥ã‚ãŸã‚Šã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒ¡ãƒ³ãƒãƒ¼æ•°" "$file" | head -1 | sed 's/.*æ•°[ã¯ã‚]//' | sed 's/äºº.*/äºº/')
    local description=$(grep -A5 "### OSMã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã®çŠ¶æ³" "$file" | grep "^-" | head -1 | sed 's/^- //')
    
    # å›½åãƒãƒƒãƒ”ãƒ³ã‚°ï¼ˆå›½ã‚³ãƒ¼ãƒ‰ã‹ã‚‰æ—¥æœ¬èªåã¸ï¼‰
    case "$country_code" in
        "jp") country_name="æ—¥æœ¬ (Japan)" ;;
        "th") country_name="ã‚¿ã‚¤ (Thailand)" ;;
        "tw") country_name="å°æ¹¾ (Taiwan)" ;;
        "tl") country_name="æ±ãƒ†ã‚£ãƒ¢ãƒ¼ãƒ« (Timor-Leste)" ;;
        "bd") country_name="ãƒãƒ³ã‚°ãƒ©ãƒ‡ã‚·ãƒ¥ (Bangladesh)" ;;
        "pg") country_name="ãƒ‘ãƒ—ã‚¢ãƒ‹ãƒ¥ãƒ¼ã‚®ãƒ‹ã‚¢ (Papua New Guinea)" ;;
        "jo") country_name="ãƒ¨ãƒ«ãƒ€ãƒ³ (Jordan)" ;;
        "mm") country_name="ãƒŸãƒ£ãƒ³ãƒãƒ¼ (Myanmar)" ;;
        "uk") country_name="ã‚¤ã‚®ãƒªã‚¹ (United Kingdom)" ;;
        "us") country_name="ã‚¢ãƒ¡ãƒªã‚«åˆè¡†å›½ (United States)" ;;
        *) country_name="$country_code" ;;
    esac
    
    # å›½æ——çµµæ–‡å­—ãƒãƒƒãƒ”ãƒ³ã‚°
    case "$country_code" in
        "jp") flag="ğŸ‡¯ğŸ‡µ" ;;
        "th") flag="ğŸ‡¹ğŸ‡­" ;;
        "tw") flag="ğŸ‡¹ğŸ‡¼" ;;
        "tl") flag="ğŸ‡¹ğŸ‡±" ;;
        "bd") flag="ğŸ‡§ğŸ‡©" ;;
        "pg") flag="ğŸ‡µğŸ‡¬" ;;
        "jo") flag="ğŸ‡¯ğŸ‡´" ;;
        "mm") flag="ğŸ‡²ğŸ‡²" ;;
        "uk") flag="ğŸ‡¬ğŸ‡§" ;;
        "us") flag="ğŸ‡ºğŸ‡¸" ;;
        *) flag="ğŸŒ" ;;
    esac
    
    echo "$flag [$country_name]($file)"
    
    # ç‰¹å¾´çš„ãªæƒ…å ±ã‚’æŠ½å‡º
    if grep -q "æ´»ç™ºãªOSMã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£" "$file"; then
        echo "- æ´»ç™ºãªOSMã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£"
    fi
    if grep -q "ç½å®³å¯¾å¿œ" "$file"; then
        echo "- ç½å®³å¯¾å¿œãƒãƒƒãƒ”ãƒ³ã‚°"
    fi
    if grep -q "å¤§å­¦" "$file"; then
        echo "- å¤§å­¦é€£æºæ´»å‹•"
    fi
}

# ç¾åœ¨ã®æ—¥ä»˜ã‚’å–å¾—
current_date=$(date +"%Yå¹´%mæœˆ%dæ—¥")

echo "ğŸ“‹ åˆ©ç”¨å¯èƒ½ãªå›½ãƒ»åœ°åŸŸãƒ•ã‚¡ã‚¤ãƒ«:"
for file in *.md; do
    if [[ "$file" != "_"* && "$file" != "index.md" ]]; then
        echo "  - $file"
    fi
done

echo "\nğŸ”„ index.md ã‚’æ›´æ–°ä¸­..."

# ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ
temp_file=$(mktemp)

cat > "$temp_file" << 'EOF'
# ã‚¨ãƒªã‚¢åˆ¥OpenStreetMapæ´»å‹•è¨˜éŒ²

QMPãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ã€å„å›½ãƒ»åœ°åŸŸã«ãŠã‘ã‚‹OpenStreetMapã®æ´»å‹•çŠ¶æ³ã¨JICAãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¨ã®é–¢é€£æ€§ã‚’ä½“ç³»çš„ã«è¨˜éŒ²ã—ã¦ã„ã¾ã™ã€‚

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æ¦‚è¦

### ãƒ“ã‚¸ãƒ§ãƒ³
**courage to map** - ã¡ã‚‡ã£ã¨ã—ãŸå‹‡æ°—ã§åœ°å›³ã‚’ä½œã‚‹

### ãƒŸãƒƒã‚·ãƒ§ãƒ³
ç§ãŸã¡ã¯ç”ŸæˆAIã¨å…±å‰µã—ã€å›½éš›å”åŠ›åˆ†é‡ã§ã®OpenStreetMapæ´»ç”¨ã‚’ä¿ƒé€²ã—ã¾ã™ã€‚

## å¯¾è±¡å›½ãƒ»åœ°åŸŸä¸€è¦§

### ã‚¢ã‚¸ã‚¢ãƒ»å¤ªå¹³æ´‹åœ°åŸŸ

EOF

# ã‚¢ã‚¸ã‚¢ãƒ»å¤ªå¹³æ´‹åœ°åŸŸã®å›½ã€…ã‚’è¿½åŠ 
for country_code in jp th tw tl bd mm pg; do
    file="${country_code}.md"
    if [[ -f "$file" ]]; then
        case "$country_code" in
            "jp")
                echo "#### ğŸ‡¯ğŸ‡µ [æ—¥æœ¬ (Japan)](jp.md)" >> "$temp_file"
                echo "- æ´»ç™ºãªOSMã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ï¼ˆ150äºº/æ—¥ï¼‰" >> "$temp_file"
                echo "- ç½å®³å¯¾å¿œãƒãƒƒãƒ”ãƒ³ã‚°ã®å…ˆé€²äº‹ä¾‹" >> "$temp_file"
                echo "- æŠ€è¡“ç ”ä¿®æ‹ ç‚¹ã¨ã—ã¦ã®æ©Ÿèƒ½" >> "$temp_file"
                echo "" >> "$temp_file"
                ;;
            "th")
                echo "#### ğŸ‡¹ğŸ‡­ [ã‚¿ã‚¤ (Thailand)](th.md)" >> "$temp_file"
                echo "- ASEANåœ°åŸŸã®ãƒãƒ–æ©Ÿèƒ½" >> "$temp_file"
                echo "- å¤§å­¦ç”Ÿã«ã‚ˆã‚‹æ´»ç™ºãªãƒãƒƒãƒ”ãƒ³ã‚°" >> "$temp_file"
                echo "- åœ°æ–¹é–‹ç™ºãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¨ã®é€£æº" >> "$temp_file"
                echo "" >> "$temp_file"
                ;;
            "tw")
                echo "#### ğŸ‡¹ğŸ‡¼ [å°æ¹¾ (Taiwan)](tw.md)" >> "$temp_file"
                echo "- éå¸¸ã«æ´»ç™ºãªOSMã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ï¼ˆ100äººä»¥ä¸Š/æ—¥ï¼‰" >> "$temp_file"
                echo "- é«˜å“è³ªãªåœ°å›³ãƒ‡ãƒ¼ã‚¿æ•´å‚™" >> "$temp_file"
                echo "- ç¬¬ä¸‰å›½ç ”ä¿®ã§ã®æ‹ ç‚¹æ©Ÿèƒ½" >> "$temp_file"
                echo "" >> "$temp_file"
                ;;
            "tl")
                echo "#### ğŸ‡¹ğŸ‡± [æ±ãƒ†ã‚£ãƒ¢ãƒ¼ãƒ« (Timor-Leste)](tl.md)" >> "$temp_file"
                echo "- æ–°èˆˆãƒãƒƒãƒ”ãƒ³ã‚°ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ï¼ˆ30äºº/æ—¥ï¼‰" >> "$temp_file"
                echo "- å¤šè¨€èªå¯¾å¿œã®é‡è¦æ€§" >> "$temp_file"
                echo "- åŸºç¤çš„ãƒãƒƒãƒ”ãƒ³ã‚°æŠ€è¡“ã®æ™®åŠ" >> "$temp_file"
                echo "" >> "$temp_file"
                ;;
            "bd")
                echo "#### ğŸ‡§ğŸ‡© [ãƒãƒ³ã‚°ãƒ©ãƒ‡ã‚·ãƒ¥ (Bangladesh)](bd.md)" >> "$temp_file"
                echo "- äººé“æ”¯æ´ãƒãƒƒãƒ”ãƒ³ã‚°æ´»å‹•" >> "$temp_file"
                echo "- ç½å®³å¯¾å¿œãƒ»é˜²ç½åˆ†é‡ã§ã®å”åŠ›" >> "$temp_file"
                echo "- è¾²æ‘éƒ¨é–‹ç™ºãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ" >> "$temp_file"
                echo "" >> "$temp_file"
                ;;
            "mm")
                echo "#### ğŸ‡²ğŸ‡² [ãƒŸãƒ£ãƒ³ãƒãƒ¼ (Myanmar)](mm.md)" >> "$temp_file"
                echo "- ç™ºå±•é€”ä¸Šã®OSMã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£" >> "$temp_file"
                echo "- æ°‘ä¸»åŒ–ãƒ—ãƒ­ã‚»ã‚¹ã§ã®ãƒãƒƒãƒ”ãƒ³ã‚°æ´»å‹•" >> "$temp_file"
                echo "- ã‚¤ãƒ³ãƒ•ãƒ©æ•´å‚™æ”¯æ´ã®å¿…è¦æ€§" >> "$temp_file"
                echo "" >> "$temp_file"
                ;;
            "pg")
                echo "#### ğŸ‡µğŸ‡¬ [ãƒ‘ãƒ—ã‚¢ãƒ‹ãƒ¥ãƒ¼ã‚®ãƒ‹ã‚¢ (Papua New Guinea)](pg.md)" >> "$temp_file"
                echo "- å³¶å¶¼å›½ç‰¹æœ‰ã®åœ°å›³èª²é¡Œ" >> "$temp_file"
                echo "- é‰±æ¥­ãƒ»æ—æ¥­åˆ†é‡ã§ã®å”åŠ›" >> "$temp_file"
                echo "- åœ°æ–¹éƒ¨ã‚¤ãƒ³ãƒ•ãƒ©æ•´å‚™æ”¯æ´" >> "$temp_file"
                echo "" >> "$temp_file"
                ;;
        esac
    fi
done

# ä¸­æ±ãƒ»ã‚¢ãƒ•ãƒªã‚«åœ°åŸŸ
cat >> "$temp_file" << 'EOF'
### ä¸­æ±ãƒ»ã‚¢ãƒ•ãƒªã‚«åœ°åŸŸ

#### ğŸ‡¯ğŸ‡´ [ãƒ¨ãƒ«ãƒ€ãƒ³ (Jordan)](jo.md)
- é™å®šçš„ãªOSMã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ï¼ˆ3äºº/æ—¥ï¼‰
- é›£æ°‘ã‚­ãƒ£ãƒ³ãƒ—åœ°å›³åŒ–ã¸ã®é…æ…®
- æ°´è³‡æºç®¡ç†åˆ†é‡ã§ã®æŠ€è¡“å”åŠ›

### æ¬§ç±³åœ°åŸŸ

#### ğŸ‡¬ğŸ‡§ [ã‚¤ã‚®ãƒªã‚¹ (United Kingdom)](uk.md)
- OSMç™ºç¥¥åœ°ã¨ã—ã¦ã®æ­´å²çš„é‡è¦æ€§
- å­¦è¡“ç ”ç©¶ã¨ã®é€£æºå¼·åŒ–
- è‹±é€£é‚¦ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®æ´»ç”¨

#### ğŸ‡ºğŸ‡¸ [ã‚¢ãƒ¡ãƒªã‚«åˆè¡†å›½ (United States)](us.md)
- ä¸–ç•Œæœ€å¤§ç´šã®OSMã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ï¼ˆ1000äººä»¥ä¸Š/æ—¥ï¼‰
- HOTæœ¬æ‹ åœ°ã¨ã—ã¦ã®äººé“æ”¯æ´
- ç½å®³å¯¾å¿œæŠ€è¡“ã®å›½éš›é€£æº

## æ´»ç”¨æ–¹æ³•

### æ–°è¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç«‹æ¡ˆæ™‚
1. å¯¾è±¡å›½ã®OSMã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£çŠ¶æ³ã‚’ç¢ºèª
2. æ—¢å­˜JICAãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¨ã®é€£æºå¯èƒ½æ€§ã‚’æ¤œè¨
3. è¨€èªå¯¾å¿œã¨ç¾åœ°é€£æºæ–¹é‡ã‚’æ±ºå®š
4. æŠ€è¡“çš„åˆ¶ç´„ã¨èª²é¡Œã‚’æŠŠæ¡

### ãƒãƒƒãƒ”ãƒ³ã‚°å®Ÿæ–½æ™‚
1. å›½ãƒ»åœ°åŸŸç‰¹æœ‰ã®è€ƒæ…®äº‹é …ã‚’ç¢ºèª
2. æ¨å¥¨ã•ã‚Œã‚‹ã‚¿ã‚°ä»˜ã‘ä¾‹ã‚’å‚ç…§
3. æ³¨æ„äº‹é …ã‚’éµå®ˆ
4. ç¾åœ°ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã¨ã®é€£æºã‚’é‡è¦–

### å“è³ªç®¡ç†
1. çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã§æ´»å‹•çŠ¶æ³ã‚’æŠŠæ¡
2. æŠ€è¡“çš„æƒ…å ±ã§é©åˆ‡ãªãƒ„ãƒ¼ãƒ«é¸æŠ
3. é–¢é€£ãƒªã‚½ãƒ¼ã‚¹ã§æƒ…å ±åé›†
4. å®šæœŸçš„ãªæ›´æ–°ã¨æ”¹å–„

## å“è³ªä¿è¨¼

### æ–‡æ›¸å“è³ªåŸºæº–
- âœ… å¿…é ˆã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼š8é …ç›®å®Œå‚™
- âœ… æ¨å¥¨ã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼š4é …ç›®å……å®Ÿ
- âœ… å®Ÿç”¨çš„ãªã‚¿ã‚°ä»˜ã‘ä¾‹
- âœ… æ³¨æ„äº‹é …ã®æ˜ç¢ºåŒ–

### ç¶™ç¶šçš„æ”¹å–„
- æœˆæ¬¡ã§ã®çµ±è¨ˆãƒ‡ãƒ¼ã‚¿æ›´æ–°
- ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯åæ˜ 
- æ–°è¦å›½ãƒ»åœ°åŸŸã®æ®µéšçš„è¿½åŠ 
- å“è³ªãƒã‚§ãƒƒã‚¯è‡ªå‹•åŒ–

## æŠ€è¡“çš„ã‚µãƒãƒ¼ãƒˆ

### è‡ªå‹•åŒ–ãƒ„ãƒ¼ãƒ«
- [`quality-check.sh`](quality-check.sh): å“è³ªç›£è¦–ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
- [`update-index.sh`](update-index.sh): index.mdè‡ªå‹•æ›´æ–°
- [`_template.md`](_template.md): æ–°è¦å›½è¿½åŠ ç”¨ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
- [`Makefile`](../../../../../../Makefile): ã‚¿ã‚¹ã‚¯è‡ªå‹•åŒ–

### æ¨™æº–åŒ–è³‡æ–™
- [å“è³ªå‘ä¸Šæˆ¦ç•¥](_quality-strategy.md)
- [å®Œäº†ãƒ¬ãƒãƒ¼ãƒˆ](_completion-report.md)

## è²¢çŒ®æ–¹æ³•

### æ–°è¦å›½ãƒ»åœ°åŸŸã®è¿½åŠ 
1. `_template.md`ã‚’å‚è€ƒã«æ–°è¦ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ
2. ç¾åœ°èª¿æŸ»ã«ã‚ˆã‚‹æƒ…å ±åé›†
3. ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã¨ã®é€£æºç¢ºç«‹
4. å“è³ªãƒã‚§ãƒƒã‚¯å®Ÿæ–½

### æ—¢å­˜æƒ…å ±ã®æ›´æ–°
1. çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã®å®šæœŸæ›´æ–°
2. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæƒ…å ±ã®è¿½åŠ 
3. æŠ€è¡“çš„æƒ…å ±ã®æ”¹å–„
4. ãƒªã‚½ãƒ¼ã‚¹ãƒªãƒ³ã‚¯ã®æ¤œè¨¼

## é–¢é€£ãƒªãƒ³ã‚¯

- [QMPãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦](../../index.md)
- [ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚¿ã‚°ä»˜ã‘æŒ‡é‡](../project-tagging.md)
- [ç”¨èªé›†](../../terminology.md)
- [è²¢çŒ®ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³](../../contributing.md)

---

**courage to map** - ç§ãŸã¡ã¯ç”ŸæˆAIã¨å…±å‰µã—ã€ä¸–ç•Œä¸­ã®ãƒãƒƒãƒ”ãƒ³ã‚°ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã«å‹‡æ°—ã‚’ä¸ãˆã‚‹åœ°å›³ã‚’ä½œã‚Šã¾ã™ ğŸ—ºï¸

EOF

# ç¾åœ¨ã®æ—¥ä»˜ã‚’è¿½åŠ 
echo "*æœ€çµ‚æ›´æ–°: $current_date*" >> "$temp_file"

# ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç½®æ›
mv "$temp_file" "index.md"

echo "âœ… index.md ã‚’æ›´æ–°ã—ã¾ã—ãŸ"

# çµ±è¨ˆæƒ…å ±ã‚’è¡¨ç¤º
total_countries=$(ls *.md | grep -v "_" | grep -v "index.md" | wc -l | tr -d ' ')
echo "\nğŸ“Š çµ±è¨ˆæƒ…å ±:"
echo "  - ç™»éŒ²å›½ãƒ»åœ°åŸŸæ•°: $total_countries"
echo "  - æœ€çµ‚æ›´æ–°æ—¥: $current_date"

echo "\nğŸ‰ index.md ã®è‡ªå‹•æ›´æ–°ãŒå®Œäº†ã—ã¾ã—ãŸï¼"
